:root {
      color-scheme: dark;
      --primary: #4f7cff;
      --primary-hover: #3b66e0;
      --primary-soft: rgba(79, 124, 255, 0.18);
      --secondary: #0f172a;
      --accent: #1e9bd7;
      --bg: #0d111a;
      --card: rgba(20, 24, 36, 0.72);
      --text-main: #e5e7eb;
      --text-muted: rgba(229, 231, 235, 0.6);
      --border: rgba(148, 163, 184, 0.18);
      --success: #22c55e;
      --danger: #ef4444;
      --shadow-sm: 0 10px 24px rgba(3, 7, 18, 0.35);
      --shadow-lg: 0 30px 80px rgba(2, 6, 23, 0.55);
      --radius-lg: 18px;
      --radius-md: 12px;
      --field: rgba(15, 20, 30, 0.9);
    }

    @import url("https://fonts.googleapis.com/css2?family=Source+Sans+3:wght@400;500;600;700&family=JetBrains+Mono:wght@400;600&display=swap");

    * { box-sizing: border-box; -webkit-font-smoothing: antialiased; }
    body {
      margin: 0;
      font-family: "Source Sans 3", "PingFang SC", "Microsoft YaHei", sans-serif;
      color: var(--text-main);
      background: radial-gradient(circle at 20% 10%, rgba(76, 123, 255, 0.25), transparent 45%),
        radial-gradient(circle at 80% 0%, rgba(30, 155, 215, 0.25), transparent 45%),
        linear-gradient(140deg, #0b1020 0%, #0f172a 40%, #111827 100%);
      line-height: 1.5;
    }
    body::before {
      content: "";
      position: fixed;
      inset: 0;
      background: linear-gradient(180deg, rgba(15, 23, 42, 0.35), rgba(8, 12, 20, 0.6));
      z-index: -1;
    }

    /* 布局容器 */
    .app-shell {
      width: 100%;
      max-width: none;
      margin: 0;
      padding: 24px 24px 96px;
      display: grid;
      grid-template-areas: 
        "nav nav"
        "main side";
      grid-template-columns: 1fr 380px;
      gap: 16px;
    }

    /* 顶栏导航 */
    nav.app-nav {
      grid-area: nav;
      display: flex;
      justify-content: space-between;
      align-items: center;
      background: rgba(17, 24, 39, 0.72);
      padding: 8px 16px;
      border-radius: var(--radius-lg);
      border: 1px solid var(--border);
      box-shadow: var(--shadow-lg);
      backdrop-filter: blur(12px);
    }
    .brand h1 { font-size: 22px; margin: 0; font-weight: 700; letter-spacing: 0.6px; font-family: "Source Sans 3", "PingFang SC", "Microsoft YaHei", sans-serif; color: var(--primary); }
    .brand p { margin: 2px 0 0; font-size: 11px; color: var(--text-muted); }
    .nav-stats { display: flex; gap: 10px; }
    .chip {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 6px 10px;
      border-radius: 999px;
      border: 1px solid var(--border);
      background: rgba(15, 20, 30, 0.85);
      box-shadow: var(--shadow-sm);
      font-size: 11px;
      color: var(--text-main);
      letter-spacing: 0.2px;
      text-decoration: none;
    }
    .pill {
      padding: 4px 10px;
      border-radius: 999px;
      background: rgba(79, 124, 255, 0.2);
      color: #dbeafe;
      font-size: 11px;
      font-weight: 700;
      letter-spacing: 0.4px;
    }
    .nav-home:hover {
      border-color: rgba(79, 124, 255, 0.5);
      background: rgba(30, 41, 59, 0.9);
    }

    /* 侧边栏 */
    .app-side {
      grid-area: side;
      display: flex;
      flex-direction: column;
      gap: 16px;
    }

    /* 主内容区 */
    .app-main {
      grid-area: main;
      display: flex;
      flex-direction: column;
      gap: 16px;
    }

    /* 通用卡片样式 */
    .card {
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: var(--radius-lg);
      box-shadow: var(--shadow-sm);
      overflow: hidden;
      transition: transform 0.2s ease, box-shadow 0.2s ease;
      animation: rise 0.6s ease both;
    }
    .card:hover { box-shadow: var(--shadow-lg); }
    .card-header {
      padding: 12px 16px;
      border-bottom: 1px solid var(--border);
      display: flex;
      align-items: center;
      justify-content: space-between;
      background: rgba(16, 20, 32, 0.9);
    }
    .card-header h2 { font-size: 11px; font-weight: 700; margin: 0; color: var(--text-muted); text-transform: uppercase; display: flex; align-items: center; gap: 8px; letter-spacing: 1px; }
    .card-body { padding: 14px 16px; }
    .editor-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; align-items: start; }
    .editor-left, .editor-right { display: flex; flex-direction: column; }
    .editor-right-panel { padding: 10px; background: var(--card); border-radius: 8px; border: 1px solid var(--border); margin-top: 26px; }

    /* 按钮与表单 */
    .form-item { margin-bottom: 10px; }
    label { display: block; font-size: 12px; font-weight: 600; color: var(--text-muted); margin-bottom: 6px; letter-spacing: 0.2px; }
    input, textarea, select {
      width: 100%;
      padding: 8px 10px;
      border-radius: var(--radius-md);
      border: 1px solid var(--border);
      font-size: 12px;
      background: var(--field);
      transition: 0.2s;
      color: var(--text-main);
    }
    input:focus, textarea:focus, select:focus { outline: none; border-color: var(--primary); background: var(--field); box-shadow: 0 0 0 4px var(--primary-soft); }
    select {
      appearance: auto;
      background-image: none;
    }
    input::placeholder, textarea::placeholder { color: rgba(229, 231, 235, 0.45); }

    .btn {
      padding: 7px 12px;
      border-radius: var(--radius-md);
      border: 1px solid transparent;
      font-size: 11px;
      font-weight: 600;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      transition: 0.2s;
      line-height: 1.2;
    }
    .btn-primary {
      background: var(--primary);
      color: #fff;
      border-color: rgba(37, 99, 235, 0.35);
      box-shadow: 0 10px 22px -12px rgba(37, 99, 235, 0.6);
    }
    .btn-primary:hover { box-shadow: 0 14px 26px -12px rgba(37, 99, 235, 0.75); }
    .btn-ghost {
      background: rgba(15, 20, 30, 0.85);
      color: var(--text-main);
      border: 1px solid var(--border);
      box-shadow: var(--shadow-sm);
    }
    .btn-ghost:hover { background: rgba(30, 41, 59, 0.9); color: var(--text-main); }
    .btn-danger {
      background: rgba(239, 68, 68, 0.18);
      color: #fecaca;
      border: 1px solid rgba(239, 68, 68, 0.35);
    }
    .btn:focus-visible { outline: 2px solid rgba(37, 99, 235, 0.4); outline-offset: 2px; }
    .file-row { display: inline-flex; gap: 0; align-items: center; margin: 0; justify-content: flex-start; }
    .file-input { display: none; }
    .file-btn, .file-cancel { white-space: nowrap; margin: 0; }
    .form-center { text-align: left; max-width: 360px; margin: 0; }
    .form-center #refImagePreview { max-width: 100%; }

    .monitor-placeholder { color: rgba(229, 231, 235, 0.45); text-align: center; }
    .monitor-placeholder i { display: block; margin: 0 auto 12px; opacity: 0.5; }

    .credit-ok { color: var(--success); }
    .credit-low { color: var(--danger); }
    .credit-empty { color: var(--text-muted); }

    /* 角色资产面板 */
    .role-panel { display: grid; gap: 14px; }
    .role-tabs { display: flex; gap: 6px; background: rgba(79, 124, 255, 0.12); padding: 4px; border-radius: 10px; border: 1px solid var(--border); }
    .role-tabs .btn { border-radius: 8px; }
    .role-merged { display: grid; gap: 12px; grid-template-columns: 1fr; }
    .role-block { min-width: 0; }
    @media (min-width: 1200px) {
      .role-merged { grid-template-columns: 1fr 1fr; }
    }
    .role-section {
      padding: 12px;
      border-radius: 12px;
      border: 1px dashed rgba(148, 163, 184, 0.2);
      background: linear-gradient(135deg, rgba(15, 20, 30, 0.85), rgba(20, 24, 36, 0.9));
    }
    .role-section h3 { margin: 0 0 8px; font-size: 12px; text-transform: uppercase; letter-spacing: 1px; color: var(--text-muted); }
    .role-status {
      padding: 12px;
      border-radius: 12px;
      border: 1px solid var(--border);
      background: rgba(16, 20, 32, 0.9);
      display: grid;
      gap: 6px;
      font-size: 12px;
    }
    .role-status .row { display: flex; justify-content: space-between; gap: 8px; }
    .role-badge { padding: 2px 8px; border-radius: 999px; background: rgba(79, 124, 255, 0.2); color: #dbeafe; font-size: 11px; font-weight: 600; }
    .role-actions { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
    .role-actions .btn { width: 100%; }

    /* 视频库卡片 */
    .video-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 10px; }
    .video-card { background: var(--card); border: 1px solid var(--border); border-radius: var(--radius-md); padding: 12px; position: relative; transition: 0.2s; }
    .video-card:hover { transform: none; box-shadow: var(--shadow-lg); }
    .video-thumb {
      width: 100%;
      height: 120px;
      aspect-ratio: 16 / 9;
      object-fit: cover;
      display: block;
      border-radius: 6px;
      background: #000;
      margin-bottom: 8px;
      border: 1px solid var(--border);
    }
    .v-meta { font-size: 10px; color: var(--text-muted); display: grid; grid-template-columns: repeat(2, minmax(0, 1fr)); gap: 4px 10px; }
    .v-prompt {
      font-size: 10px;
      color: var(--text-muted);
      margin-top: 6px;
      line-height: 1.3;
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    .ref-list { display: flex; flex-wrap: wrap; gap: 6px; margin-top: 6px; }
    .ref-chip { padding: 3px 10px; border-radius: 999px; border: 1px solid var(--border); background: rgba(15, 20, 30, 0.85); font-size: 11px; color: var(--text-muted); cursor: pointer; display: inline-flex; align-items: center; gap: 6px; }
    .ref-chip:hover { border-color: var(--primary); color: var(--primary); background: var(--primary-soft); }
    .ref-del { display: inline-flex; align-items: center; justify-content: center; width: 16px; height: 16px; border-radius: 50%; border: 1px solid var(--border); font-size: 12px; line-height: 1; color: var(--text-muted); background: rgba(15, 20, 30, 0.85); }
    .ref-chip:hover .ref-del { border-color: var(--primary); color: var(--primary); background: var(--primary-soft); }

    /* 进度条 */
    .progress-wrap { margin-top: 15px; }
    .progress-bar { height: 8px; background: rgba(148, 163, 184, 0.2); border-radius: 10px; overflow: hidden; }
    .progress-inner { height: 100%; width: 0%; background: var(--primary); transition: 0.3s; }

    .active-list { display: flex; flex-direction: column; gap: 8px; margin-top: 10px; }
    .active-item { border: 1px solid var(--border); border-radius: 8px; padding: 10px; background: rgba(16, 20, 32, 0.9); }
    .active-title {
      font-size: 13px;
      font-weight: 700;
      color: var(--text-main);
      margin-bottom: 6px;
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
      overflow: hidden;
    }
    .active-meta { font-size: 10px; color: var(--text-muted); display: flex; gap: 10px; flex-wrap: wrap; }
    .active-progress { margin-top: 8px; }
    .active-bar { height: 8px; background: rgba(148, 163, 184, 0.2); border-radius: 8px; overflow: hidden; }
    .active-bar > div { height: 100%; background: var(--primary); width: 0%; transition: width 0.3s; }

    /* 日志控制台 */
    .console { background: #0f172a; color: #7dd3fc; font-family: "JetBrains Mono", monospace; font-size: 11px; padding: 12px; border-radius: var(--radius-md); height: auto; min-height: 0; overflow-y: auto; white-space: pre-wrap; word-break: break-word; border: 1px solid rgba(15, 23, 42, 0.2); flex: 1; }
    .section-grid { display: grid; grid-template-columns: 1fr; gap: 12px; align-items: stretch; }
    .section-grid > .card { display: flex; flex-direction: column; min-height: 0; }
    .section-grid > .card .card-body { padding: 16px; display: flex; flex-direction: column; min-height: 0; }
    .section-title {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 11px;
      color: var(--text-muted);
      text-transform: uppercase;
      letter-spacing: 0.8px;
      margin-bottom: 8px;
    }
    .video-actions { display: flex; gap: 6px; align-items: center; }

    @media (max-width: 720px) {
      .app-shell { grid-template-areas: "nav" "main" "side"; grid-template-columns: 1fr; }
      nav.app-nav { flex-direction: column; align-items: flex-start; gap: 12px; }
      .nav-stats { flex-wrap: wrap; }
    }
    @media (max-width: 1100px) {
      .section-grid { grid-template-columns: 1fr; }
    }

    @keyframes rise {
      from { opacity: 0; transform: translateY(12px); }
      to { opacity: 1; transform: translateY(0); }
    }
    @media (prefers-reduced-motion: reduce) {
      .card { animation: none; }
      .btn, .video-card { transition: none; }
    }
